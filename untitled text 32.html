Error opening zip file or JAR manifest missing : /app/log-level-agent.jar
Error occurred during initialization of VM
agent library failed to init: instrument

public class LogLevelStartUpAgent {
public static final int TIMEOUT = 15000;
public static final String LOG_LEVEL_CHANGES_DURATION = "log.level.changes.duration";
public static final int LOG_LEVEL_CHANGES_DURATION_DEFAULT = 10;
public static final String LOG4J2_XML_FILE_NAME = "/app/log4j2.xml";
public static final String LOG_LEVEL_CONTROLLER_HOST = "log.level.controller.host";

/**
 * Method to check if there is any update on logging config via Java Instrumentation Agent
 * @param agentArgs
 * @param inst
 */
public static void premain(String agentArgs, Instrumentation inst) {
    try {
        fetchUpdatedLog4jXml();

        ScheduledExecutorService scheduledExecutorService = Executors.newScheduledThreadPool(1);
        Runnable checkLogLevelTask = LogLevelStartUpAgent::fetchUpdatedLog4jXml;

        long logLevelChangesDuration = LOG_LEVEL_CHANGES_DURATION_DEFAULT;
        try{
            logLevelChangesDuration = Long.parseLong(System.getProperty(LOG_LEVEL_CHANGES_DURATION));
        } catch (Exception e) {
            System.err.println("unable to get property log.level.changes.duration setting default value as 10 seconds: " + e.getMessage());
        }
        scheduledExecutorService.scheduleAtFixedRate(checkLogLevelTask, logLevelChangesDuration, logLevelChangesDuration, TimeUnit.SECONDS);

    } catch (Exception e) {
        System.err.println("Error calling REST API: " + e.getMessage());
    }
}

/**
 * Method to call generate-log4j-xml REST API to check if Log4j2 configuration has been updated
 */
public static void fetchUpdatedLog4jXml() {
    try {
        String loggingLevelClientAppUrl = System.getProperty(LOG_LEVEL_CONTROLLER_HOST) + "/" + LOG4J2_XML_FILE_NAME;
        System.out.println("Calling /Log4j.xml service to fetch updated Logging level : at " + Instant.now());
        URL url = new URL(loggingLevelClientAppUrl);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestProperty("Accept", "application/xml");
        connection.setRequestMethod("GET");
        connection.setConnectTimeout(TIMEOUT);
        connection.setReadTimeout(TIMEOUT);
        int responseCode = connection.getResponseCode();
        if (responseCode == 200) {
            File outputFile = new File(LOG4J2_XML_FILE_NAME);
            try (InputStream inputStream = connection.getInputStream();
                 FileOutputStream fileOutputStream = new FileOutputStream(outputFile)) {

                byte[] buffer = new byte[1024];
                int bytesRead;
                while ((bytesRead = inputStream.read(buffer)) != -1) {
                    fileOutputStream.write(buffer, 0, bytesRead);
                }
            }
        }
    } catch (Exception e) {
        System.err.println("Error calling REST API to fetch updated Log4j2.xml file: " + e.getMessage());
    }
}
}
